
make sure code is up to date and everything is in svn:

ant clean
svn update
svn status

run version update script at the top level:

./tools/shell/update_version.sh <version>

    tasks implemented by script:
    update pmd.bat, designer.bat, bgastviewer.*, cpd.jnlp, cpdgui.bat, build.xml to point to pmd-<version>.jar
    update PMD.java, xdocs/running.xml, compiling.xml, integrations.xml, installing.xml to reflect pmd-<version>
    update the release date in the changelog
    update release number and tag name in project.xml

then, run the script that will generate the proper rulesets/rulesets.properties

./tools/shell/updating_rulesets.sh rulesets/rulesets.properties
	update rulesets/rulesets.properties - add any new ruleset file names

ensure all the new rules are listed in a rulesets/releases/<version>.xml file

ant recompile regress test
Check in everything

Run all regression tests and various ant tasks:

ant qa

TESTS: Can you run 1 file and get a report
./bin/pmd.sh ~/tmp/Test.java xml unusedcode
./bin/pmd.sh ~/tmp/Test.java html rulesets/unusedcode.xml

run "./generate_release.sh <version> release" in tools/shell

It will run:

	ant dist
	mvn site

	generate the binary zip file

	svn tag if "yes" is pressed

	generate the source zip file

if you see a bug and fix it, you can delete the release using:
svn delete https://pmd.svn.sourceforge.net/svnroot/pmd/tags/pmd/pmd_release_<version>
and then retag it


Go to Admin, File Releases, Add release
Paste stuff into the changelog/readme boxes
Add the pmd-bin-<version>.zip file
Add the pmd-src-<version>.zip file
Classify the file
Click File Releases, Edit Release, set previous version to 'hidden'.

upload command below will create and upload the maven artifacts to sourceforge. Login info
for 'pmd-repo' must be defined in ~/.m2/settings.xml

update the "download" and "what's new" link in navigation.xml
./docs.sh upload

update cpd.jnlp by running:

ant cpdjnlp


Submit news to SF
Go to http://freshmeat.net/
Submit news to java.net
Do a blog entry


Getting the new PMD version into Maven Central Repository:
----------------------------------------------------------
1. Make sure you have a gpg key:

   gpg --list-keys

2. Create a bundle

  mvn clean source:jar javadoc:jar package gpg:sign repository:bundle-create -Dgpg.keyname=your_key -Dgpg.passphrase=your_pwd

3. The bundle is target/pmd-x.x.x-bundle.jar.

  Test it: target/pmd-x.x.x.jar is the file, that is contained in the bundle.
  So we can use it:
  
  java -cp target/pmd-x.x.x.jar:lib/asm-3.2.jar:lib/javacc.jar:lib/jaxen-1.1.1.jar net.sourceforge.pmd.PMD src/net/sourceforge/pmd/PMD.java text unusedcode

  This should work: "No problems found!"
  

4. Upload pmd-x.x.x-bundle.jar to https://oss.sonatype.org.

More info: https://docs.sonatype.org/display/Repository/Uploading+3rd-party+Artifacts+to+Maven+Central

